-- also change setup routine in keyholder-interface/acs.c!

BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS user (id INTEGER PRIMARY KEY NOT NULL, username TEXT NOT NULL, firstname TEXT, lastname TEXT, email TEXT, pw TEXT);
CREATE TABLE IF NOT EXISTS key (fingerprint CHARACTER(48) PRIMARY KEY NOT NULL, userid INTEGER NOT NULL REFERENCES user, type TEXT, base64 TEXT NOT NULL, comment TEXT, last_login INTEGER NOT NULL DEFAULT 0);
CREATE TABLE IF NOT EXISTS log (id INTEGER PRIMARY KEY AUTOINCREMENT, timestamp INTEGER NOT NULL, login_timestamp INTEGER NOT NULL, userid INTEGER NOT NULL REFERENCES user, ip TEXT, key CHARACTER(48) NOT NULL REFERENCES key, mode INTEGER NOT NULL, msg TEXT);
COMMIT;
